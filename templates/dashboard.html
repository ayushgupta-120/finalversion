{% extends "base.html" %}

{% block title %}Dashboard - Flask Auth System{% endblock %}

{% block content %}
<div class="dashboard-container">
    <h2>Welcome to Dashboard</h2>
    
    {% if user %}
    <div class="user-info">
        <h3>User Information</h3>
        <p><strong>Username:</strong> {{ user.username }}</p>
        <p><strong>Email:</strong> {{ user.email }}</p>
    </div>
    {% endif %}
    
    <!-- Simple To-Do List -->
    <div class="todo-section">
        <h3>üìù My To-Do List</h3>
        <div class="todo-input">
            <input type="text" id="taskInput" placeholder="Add a new task..." maxlength="50">
            <button onclick="addTask()">Add</button>
        </div>
        <ul id="taskList"></ul>
        <button onclick="clearAll()" class="clear-btn">Clear All</button>
    </div>
    
    <div class="actions">
        <a href="{{ url_for('logout') }}" class="btn btn-logout">Logout</a>
    </div>
</div>

<style>
    .todo-section {
        background: white;
        padding: 1.5rem;
        border-radius: 8px;
        margin: 1.5rem 0;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    
    .todo-section h3 {
        color: #2c3e50;
        margin-bottom: 1rem;
        text-align: center;
    }
    
    .todo-input {
        display: flex;
        gap: 10px;
        margin-bottom: 1rem;
    }
    
    .todo-input input {
        flex: 1;
        padding: 0.5rem;
        border: 2px solid #ddd;
        border-radius: 4px;
        font-size: 1rem;
    }
    
    .todo-input button {
        padding: 0.5rem 1rem;
        background: #27ae60;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
    }
    
    .todo-input button:hover {
        background: #219a52;
    }
    
    #taskList {
        list-style: none;
        padding: 0;
        margin: 0 0 1rem 0;
        max-height: 200px;
        overflow-y: auto;
    }
    
    .task-item {
        display: flex;
        align-items: center;
        padding: 0.7rem;
        border: 1px solid #eee;
        margin-bottom: 0.5rem;
        border-radius: 4px;
        background: #f9f9f9;
    }
    
    .task-item input[type="checkbox"] {
        margin-right: 0.7rem;
    }
    
    .task-item.completed {
        background: #f9f9f9;
    }
    
    .task-text {
        flex: 1;
    }
    
    .delete-btn {
        background: #e74c3c;
        color: white;
        border: none;
        padding: 0.3rem 0.6rem;
        border-radius: 3px;
        cursor: pointer;
        font-size: 0.8rem;
    }
    
    .delete-btn:hover {
        background: #c0392b;
    }
    
    .clear-btn {
        background: #f39c12;
        color: white;
        border: none;
        padding: 0.5rem 1rem;
        border-radius: 4px;
        cursor: pointer;
        width: 100%;
    }
    
    .clear-btn:hover {
        background: #e67e22;
    }
    
    .empty-message {
        text-align: center;
        color: #999;
        font-style: italic;
        padding: 1rem;
    }
</style>

<script>
    let tasks = [];
    let taskId = 0;

    function addTask() {
        const input = document.getElementById('taskInput');
        const text = input.value.trim();
        
        if (text === '') return;
        
        tasks.push({
            id: taskId++,
            text: text,
            completed: false
        });
        
        input.value = '';
        renderTasks();
    }

    function toggleTask(id) {
        tasks = tasks.map(task => 
            task.id === id ? {...task, completed: !task.completed} : task
        );
        renderTasks();
    }

    function deleteTask(id) {
        tasks = tasks.filter(task => task.id !== id);
        renderTasks();
    }

    function clearAll() {
        if (tasks.length > 0 && confirm('Clear all tasks?')) {
            tasks = [];
            renderTasks();
        }
    }

    function renderTasks() {
        const list = document.getElementById('taskList');
        
        if (tasks.length === 0) {
            list.innerHTML = '<li class="empty-message">No tasks yet. Add one above! üìù</li>';
            return;
        }
        
        list.innerHTML = tasks.map(task => `
            <li class="task-item ${task.completed ? 'completed' : ''}">
                <input type="checkbox" ${task.completed ? 'checked' : ''} 
                       onchange="toggleTask(${task.id})">
                <span class="task-text">${task.text}</span>
                <button class="delete-btn" onclick="deleteTask(${task.id})">√ó</button>
            </li>
        `).join('');
    }

    // Add task on Enter key
    document.addEventListener('DOMContentLoaded', function() {
        document.getElementById('taskInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') addTask();
        });
        renderTasks();
    });
</script>
{% endblock %}